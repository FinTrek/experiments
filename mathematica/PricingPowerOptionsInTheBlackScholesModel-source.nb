(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     46551,       1154]
NotebookOptionsPosition[     44673,       1087]
NotebookOutlinePosition[     45309,       1111]
CellTagsIndexPosition[     45266,       1108]
WindowFrame->Normal
ContainsDynamic->True *)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Pricing Power Options in the Black-Scholes Model", "Section",
 CellFrameColor->RGBColor[
  0.6449835965514611, 0.758632791638056, 0.2516823071641108],
 FontColor->RGBColor[
  0.6449835965514611, 0.758632791638056, 0.2516823071641108]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalN]", "[", "z_", "]"}], ":=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NumericQ", "[", "z", "]"}], "&&", 
      RowBox[{"z", "<", "0"}]}], ",", 
     RowBox[{"Erfc", "[", 
      RowBox[{
       RowBox[{"-", "z"}], "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
     RowBox[{"1", "+", 
      RowBox[{"Erf", "[", 
       RowBox[{"z", "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}]}]}], "]"}], "/", 
   "2"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.430116341964047*^9, 3.430116345508597*^9}},
 CellID->851891787],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d1", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "r_", ",", "q_", ",", "\[Sigma]_", ",", "T_", ",", 
    "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"S", "/", 
       RowBox[{"k", "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "n"}], ")"}]}]}], "]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"r", "-", "q", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", 
           RowBox[{"1", "/", "2"}]}], ")"}], 
         RowBox[{"\[Sigma]", "^", "2"}]}]}], ")"}], "T"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"\[Sigma]", " ", 
     RowBox[{"Sqrt", "[", "T", "]"}]}], ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{"d2", "[", 
   RowBox[{
   "S_", ",", "k_", ",", "r_", ",", "q_", ",", "\[Sigma]_", ",", "T_", ",", 
    "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"d1", "[", 
    RowBox[{
    "S", ",", "k", ",", "r", ",", "q", ",", "\[Sigma]", ",", "T", ",", "n"}], 
    "]"}], "-", 
   RowBox[{"n", " ", "\[Sigma]", " ", 
    RowBox[{"Sqrt", "[", "T", "]"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.43011639493254*^9, 3.43011645687954*^9}, {
   3.430138699279531*^9, 3.430138700327488*^9}, {3.4361074621407986`*^9, 
   3.4361074660541897`*^9}},
 CellID->471789560],

Cell[BoxData[{
 RowBox[{
  RowBox[{"powerPayoff", "[", 
   RowBox[{"\"\<call\>\"", ",", "S_", ",", "k_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "^", "n"}], "-", "k"}], ",", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"powerPayoff", "[", 
   RowBox[{"\"\<put\>\"", ",", "S_", ",", "k_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{
    RowBox[{"k", "-", 
     RowBox[{"S", "^", "n"}]}], ",", "0"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.4301366486049643`*^9, 3.4301368187121*^9}, 
   3.430138650304858*^9, 3.430139848628701*^9, {3.430141333732955*^9, 
   3.430141368565156*^9}, {3.4361074706276474`*^9, 3.4361074738149657`*^9}},
 CellID->1432920567],

Cell[BoxData[
 RowBox[{
  RowBox[{"powerPrice", "[", 
   RowBox[{
   "\"\<call\>\"", ",", "S_", ",", "k_", ",", "r_", ",", "q_", ",", 
    "\[Sigma]_", ",", "T_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"T", "\[Equal]", "0"}], ",", 
    RowBox[{"powerPayoff", "[", 
     RowBox[{"\"\<call\>\"", ",", "S", ",", "k", ",", "n"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "^", "n"}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"r", "+", 
             RowBox[{"n", " ", 
              RowBox[{
               RowBox[{"\[Sigma]", "^", "2"}], "/", "2"}]}]}], ")"}]}], "-", 
          RowBox[{"n", " ", "q"}]}], ")"}], "T"}], "]"}], 
      RowBox[{"\[ScriptCapitalN]", "[", 
       RowBox[{"d1", "[", 
        RowBox[{
        "S", ",", "k", ",", "r", ",", "q", ",", "\[Sigma]", ",", "T", ",", 
         "n"}], "]"}], "]"}]}], "-", 
     RowBox[{"k", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "r"}], " ", "T"}], "]"}], 
      RowBox[{"\[ScriptCapitalN]", "[", 
       RowBox[{"d2", "[", 
        RowBox[{
        "S", ",", "k", ",", "r", ",", "q", ",", "\[Sigma]", ",", "T", ",", 
         "n"}], "]"}], "]"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.4301366486049643`*^9, 3.430136768570153*^9}, {
   3.430136937551003*^9, 3.430136943159575*^9}, 3.4301386448275537`*^9, 
   3.4301398417337513`*^9, {3.4301436719631443`*^9, 3.430143739262751*^9}, {
   3.436107475387123*^9, 3.4361074811126957`*^9}},
 CellID->2005977559],

Cell[BoxData[
 RowBox[{
  RowBox[{"powerPrice", "[", 
   RowBox[{
   "\"\<put\>\"", ",", "S_", ",", "k_", ",", "r_", ",", "q_", ",", 
    "\[Sigma]_", ",", "T_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"T", "\[Equal]", "0"}], ",", 
    RowBox[{"powerPayoff", "[", 
     RowBox[{"\"\<put\>\"", ",", "S", ",", "k", ",", "n"}], "]"}], ",", 
    RowBox[{
     RowBox[{"k", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "r"}], " ", "T"}], "]"}], 
      RowBox[{"\[ScriptCapitalN]", "[", 
       RowBox[{"-", 
        RowBox[{"d2", "[", 
         RowBox[{
         "S", ",", "k", ",", "r", ",", "q", ",", "\[Sigma]", ",", "T", ",", 
          "n"}], "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"S", "^", "n"}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"r", "+", 
             RowBox[{"n", " ", 
              RowBox[{
               RowBox[{"\[Sigma]", "^", "2"}], "/", "2"}]}]}], ")"}]}], "-", 
          RowBox[{"n", " ", "q"}]}], ")"}], "T"}], "]"}], 
      RowBox[{"\[ScriptCapitalN]", "[", 
       RowBox[{"-", 
        RowBox[{"d1", "[", 
         RowBox[{
         "S", ",", "k", ",", "r", ",", "q", ",", "\[Sigma]", ",", "T", ",", 
          "n"}], "]"}]}], "]"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.4301366486049643`*^9, 3.4301368187121*^9}, 
   3.430138650304858*^9, 3.430139848628701*^9, {3.430143725657654*^9, 
   3.430143742682023*^9}, {3.43610748535312*^9, 3.4361074919807825`*^9}},
 CellID->1119059860],

Cell[BoxData[
 RowBox[{
  RowBox[{"lineStyles", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Hue", "[", 
        RowBox[{"0.67", ",", "0.6", ",", "0.6"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Dashed", ",", 
       RowBox[{"Hue", "[", 
        RowBox[{"0.91", ",", "0.6", ",", "0.6"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.430148721953451*^9, 3.430148731073542*^9}},
 CellID->1665088774],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotOpts", "=", 
   RowBox[{"Sequence", "[", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", "2", "}"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", "40"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<spot price / \!\(\*SuperscriptBox[\(strike\), \(1/n\)]\)\>\"", 
        ",", "\"\<option price / strike\>\""}], "}"}]}], ",", 
     RowBox[{"AxesOrigin", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "lineStyles"}], ",", 
     RowBox[{"Prolog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Dotted", ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1000"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1000"}], "}"}]}], "}"}], "]"}]}], "}"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.430140507173028*^9, 3.4301405699377403`*^9}, {
   3.430140720966353*^9, 3.430140746216929*^9}, {3.430140826807193*^9, 
   3.430140841392509*^9}, {3.4301410662732286`*^9, 3.430141097996369*^9}, {
   3.430141494940267*^9, 3.430141495688241*^9}, {3.4301417461067133`*^9, 
   3.4301417749275293`*^9}, {3.430144315951323*^9, 3.4301443354713078`*^9}, {
   3.430144430737706*^9, 3.430144507161498*^9}, {3.430144653773004*^9, 
   3.4301446788708878`*^9}, {3.430144735295435*^9, 3.430144762230865*^9}, {
   3.430144824482004*^9, 3.43014484656502*^9}, {3.43014857645819*^9, 
   3.430148618302359*^9}, {3.430148728701379*^9, 3.43014874377355*^9}, {
   3.4377784051388044`*^9, 3.4377784058106833`*^9}, {3.4377797055442324`*^9, 
   3.437779706122365*^9}, {3.4377798042954965`*^9, 3.4377798081549206`*^9}, {
   3.4377799044530287`*^9, 3.4377799094530926`*^9}, {3.43784909063161*^9, 
   3.4378490907046175`*^9}},
 CellID->1819795727],

Cell[BoxData[
 RowBox[{
  RowBox[{"legend", "=", 
   RowBox[{"Row", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "Black", ",", "12"}], "]"}], "]"}], "&"}], "/@",
           
          RowBox[{"{", 
           RowBox[{"\"\<current price\>\"", ",", "\"\<value at expiry\>\""}], 
           "}"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", "0.1"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], "&"}], "/@", 
          "lineStyles"}]}], "}"}], "]"}]}], ",", "\"\<   \>\""}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.43014865229958*^9, 3.430148653395258*^9}, {
   3.430148687251998*^9, 3.430148708490831*^9}, {3.430148759092165*^9, 
   3.43014879669072*^9}, {3.430148848975855*^9, 3.430148863941607*^9}},
 CellID->1450068990],

Cell[BoxData[
 RowBox[{
  RowBox[{"$spot", "=", "1."}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.430142091534399*^9, 3.4301420931091423`*^9}, 
   3.430143112068716*^9},
 CellID->692450422],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", "=", 
        RowBox[{"$spot", "^", "n"}]}], ",", 
       RowBox[{"xMin", "=", "0."}], ",", 
       RowBox[{"xMax", "=", "3."}], ",", "p", ",", "leg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"powerPrice", "[", 
            RowBox[{"type", ",", 
             RowBox[{"x", " ", "$spot"}], ",", "k", ",", 
             RowBox[{"0.01", "r"}], ",", "0", ",", 
             RowBox[{"0.01", "\[Sigma]"}], ",", "T", ",", "n"}], "]"}], ",", 
           RowBox[{"powerPayoff", "[", 
            RowBox[{"type", ",", 
             RowBox[{"x", " ", "$spot"}], ",", "k", ",", "n"}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "xMin", ",", "xMax"}], "}"}], ",", 
         RowBox[{"Evaluate", "[", "plotOpts", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "legend"}], "}"}], ",", "Center", ",", "2"}], 
       "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"type", ",", "\"\<call\>\"", ",", "\"\<option type\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<call\>\"", ",", "\"\<put\>\""}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "2.", ",", "\"\<power n\>\""}], "}"}], ",", "0.1", 
     ",", "3.", ",", "0.1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", "25.", ",", "\"\<volatility (%)\>\""}], "}"}], 
     ",", "1.", ",", "100.", ",", "1.", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "0.", ",", "\"\<risk\[Hyphen]free rate (%)\>\""}], 
      "}"}], ",", "0.", ",", "25.", ",", "1.", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", "1.", ",", "\"\<time to expiry (years)\>\""}], "}"}], 
     ",", "0.", ",", "2.", ",", "0.1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}], ",", 
   RowBox[{"AutorunSequencing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.35696210375764*^9, {3.430136963396789*^9, 3.430137111292067*^9}, {
   3.430137596512783*^9, 3.430137711279931*^9}, {3.430138868035109*^9, 
   3.430138883788068*^9}, {3.430140513751697*^9, 3.430140517123369*^9}, {
   3.4301406404586887`*^9, 3.4301406411264877`*^9}, {3.430140707880001*^9, 
   3.430140708699277*^9}, {3.43014088939369*^9, 3.430141046332633*^9}, {
   3.4301412856545067`*^9, 3.430141321541481*^9}, {3.430141658730798*^9, 
   3.430141711996052*^9}, {3.430141827049749*^9, 3.430141828995186*^9}, {
   3.43014194494028*^9, 3.430141966617177*^9}, {3.430142047834298*^9, 
   3.4301421263542223`*^9}, {3.430142269163113*^9, 3.4301422699259357`*^9}, {
   3.4301424277197247`*^9, 3.43014245569956*^9}, {3.430142512406221*^9, 
   3.430142517539963*^9}, {3.430142550904582*^9, 3.430142551041934*^9}, {
   3.430143489809189*^9, 3.430143493666547*^9}, {3.430143622150443*^9, 
   3.430143634213512*^9}, {3.430144614908544*^9, 3.430144643119982*^9}, {
   3.430145469709255*^9, 3.430145529425538*^9}, {3.4301456487573442`*^9, 
   3.4301456993904*^9}, {3.430148913922723*^9, 3.4301489177073927`*^9}, {
   3.43014894814776*^9, 3.430148948536098*^9}, {3.4361074371793027`*^9, 
   3.4361074456671515`*^9}, 3.4361075110256863`*^9, {3.437779959203729*^9, 
   3.4377799595943594`*^9}, {3.437844851759392*^9, 3.437844853787595*^9}},
 CellID->152103638]
}, Open  ]],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 2., $CellContext`r$$ = 
    0., $CellContext`T$$ = 1., $CellContext`type$$ = 
    "call", $CellContext`\[Sigma]$$ = 25., Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`type$$], "call", "option type"}, {"call", "put"}}, {{
      
       Hold[$CellContext`n$$], 2., "power n"}, 0.1, 3., 0.1}, {{
       Hold[$CellContext`\[Sigma]$$], 25., "volatility (%)"}, 1., 100., 
      1.}, {{
       Hold[$CellContext`r$$], 0., "risk\[Hyphen]free rate (%)"}, 0., 25., 
      1.}, {{
       Hold[$CellContext`T$$], 1., "time to expiry (years)"}, 0., 2., 0.1}}, 
    Typeset`size$$ = {400., {156., 161.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`type$904$$ = False, $CellContext`n$905$$ = 
    0, $CellContext`\[Sigma]$906$$ = 0, $CellContext`r$907$$ = 
    0, $CellContext`T$908$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`n$$ = 2., $CellContext`r$$ = 
        0., $CellContext`T$$ = 1., $CellContext`type$$ = 
        "call", $CellContext`\[Sigma]$$ = 25.}, "ControllerVariables" :> {
        Hold[$CellContext`type$$, $CellContext`type$904$$, False], 
        Hold[$CellContext`n$$, $CellContext`n$905$$, 0], 
        Hold[$CellContext`\[Sigma]$$, $CellContext`\[Sigma]$906$$, 0], 
        Hold[$CellContext`r$$, $CellContext`r$907$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$908$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`k$ = $CellContext`$spot^$CellContext`n$$, \
$CellContext`xMin$ = 0., $CellContext`xMax$ = 
         3., $CellContext`p$, $CellContext`leg$}, $CellContext`p$ = Plot[{
            $CellContext`powerPrice[$CellContext`type$$, $CellContext`x \
$CellContext`$spot, $CellContext`k$, 0.01 $CellContext`r$$, 0, 
             0.01 $CellContext`\[Sigma]$$, $CellContext`T$$, \
$CellContext`n$$], 
            $CellContext`powerPayoff[$CellContext`type$$, $CellContext`x \
$CellContext`$spot, $CellContext`k$, $CellContext`n$$]}, {$CellContext`x, \
$CellContext`xMin$, $CellContext`xMax$}, 
           Evaluate[$CellContext`plotOpts]]; 
        Column[{$CellContext`p$, $CellContext`legend}, Center, 2]], 
      "Specifications" :> {{{$CellContext`type$$, "call", "option type"}, {
         "call", "put"}}, {{$CellContext`n$$, 2., "power n"}, 0.1, 3., 0.1, 
         Appearance -> 
         "Labeled"}, {{$CellContext`\[Sigma]$$, 25., "volatility (%)"}, 1., 
         100., 1., Appearance -> 
         "Labeled"}, {{$CellContext`r$$, 0., "risk\[Hyphen]free rate (%)"}, 
         0., 25., 1., Appearance -> 
         "Labeled"}, {{$CellContext`T$$, 1., "time to expiry (years)"}, 0., 
         2., 0.1, Appearance -> "Labeled"}}, 
      "Options" :> {AutorunSequencing -> {1, 2, 3}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{444., {252., 257.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>(({$CellContext`$spot = 1., $CellContext`xMin = 
        0.5, $CellContext`xMax = 1.5, $CellContext`p = Graphics[
          GraphicsComplex[CompressedData["
1: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
rk2zFnX8ZL3mYv2BAFvefNBLWnmdQdb/B+LllBw=
           
           "], {{{}, {}, {}, {}, {}, {}, {}, {
              EdgeForm[], 
              Directive[{
                Opacity[0.2], 
                Hue[0.67, 0.6, 0.6]}], 
              GraphicsGroup[{
                Polygon[CompressedData["
1:eJwl1GWUUEUYBuBdlm4WpGFJCeluJFSQ7g6R7u4WUEJRAQkF6VZCQJQGCelW
uru747lnfzzz3feee87cmW/OpG/RpWbnKCEhIaGkM2xSP1DjEMZr+SkP2cwW
trKNf9jODnayi3/ZzR72so/9HOAghzjMEY5yjOP8R1LzxSUqb+RnPCKFnIAI
YpCGxKGRP/1S+Z9knuMRjbfycx5zgpOc4jRnOMs5znOBi1ziMle4yjWuc4Ob
3OI2d7jLPe6T3Hzxic47+QVPSCknJCahvPIulZqIWEQhNeHEJi1JQiN78MC3
+dnIHDYwmtmspyvfMIt11KcLXzOTvylDNVozmMmsIB95yUNucpGTHHxEdrKR
lSx8SGYykZEMpA/OChGkJQ2pg/UF6w76FexL0JOgp8F5IgmJCScRCUlAfD6m
Kq0YxE8sJx6lqUJLBjKJZcSlFJX5kgFM5HfiUJJKtKA/E/iN2JTgc76gHz+y
lFjUozOj+JW/KE5FmtOXH1hCTOrSiZHMYC3FqEAz+vA9i4lBHToygun8SVE+
oym9Gc8iolObDnzFL6yhCJ/ShF58x0KiUYv2DOdnVlOYT2hMT75lAVGpSTuG
MY1VFKI8jejBOOYTRg3aMpSp/EFBytGQ7oxlHsG9Up02DGEKKylAWRrQjTHM
DYm8g94DeCeDiA==
                 "], VertexColors -> 
                 None]}]}, {}, {}}, {{}, {}, {
              Hue[0.67, 0.6, 0.6], 
              Thickness[Large], 
              
              Line[{1, 164, 138, 113, 89, 66, 52, 178, 152, 127, 103, 80, 2, 
               165, 139, 114, 90, 67, 53, 179, 153, 128, 104, 81, 3, 166, 140,
                115, 91, 68, 54, 180, 154, 129, 105, 82, 4, 167, 141, 116, 92,
                69, 55, 181, 155, 130, 106, 83, 5, 168, 142, 117, 93, 70, 56, 
               182, 156, 131, 107, 84, 6, 169, 143, 118, 94, 71, 57, 183, 157,
                132, 108, 85, 7, 170, 144, 119, 95, 72, 58, 184, 158, 133, 
               109, 86, 8, 171, 145, 120, 96, 73, 59, 185, 159, 134, 110, 87, 
               9, 172, 146, 121, 97, 74, 60, 10, 173, 147, 122, 98, 75, 61, 
               11, 174, 148, 123, 99, 76, 62, 12, 175, 149, 124, 100, 77, 63, 
               13, 176, 150, 125, 101, 78, 64, 14, 15, 16, 17, 18, 19, 20, 21,
                22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 
               37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 177, 
               151, 126, 102, 79, 65, 186, 160, 135, 111, 88, 187, 161, 136, 
               112, 188, 162, 137, 189, 163, 190, 51}]}, {
              Hue[0.9060679774997897, 0.6, 0.6], 
              Thickness[Large], 
              Dashing[{Small, Small}], 
              
              Line[{191, 277, 267, 259, 252, 246, 242, 192, 193, 194, 195, 
               196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 
               208, 209, 210, 211, 212, 213, 214, 215, 278, 268, 260, 253, 
               247, 243, 281, 271, 287, 263, 285, 275, 256, 250, 216, 279, 
               269, 261, 254, 248, 244, 217, 218, 219, 220, 221, 222, 223, 
               224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 
               236, 237, 238, 239, 240, 280, 270, 262, 255, 249, 245, 282, 
               272, 264, 257, 251, 283, 273, 265, 258, 284, 274, 266, 286, 
               276, 288, 241}]}}}], {
          AspectRatio -> GoldenRatio^(-1), AxesOrigin -> {0, 0}, Frame -> 
           True, FrameLabel -> {
            "spot price / strike^(1/n)", "option price / strike"}, 
           ImagePadding -> {{50, 10}, {30, 10}}, ImageSize -> 400, 
           Method -> {"AxesInFront" -> True}, PlotRange -> {All, All}, 
           PlotRangeClipping -> True, 
           PlotRangePadding -> {Automatic, Automatic}, Prolog -> {
             Dashing[{0, Small}], 
             Line[{{1, -1000}, {1, 1000}}]}}], 
        Attributes[PlotRange] = {ReadProtected}, $CellContext`powerPrice[
         "call", 
          Pattern[$CellContext`S, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`r, 
           Blank[]], 
          Pattern[$CellContext`q, 
           Blank[]], 
          Pattern[$CellContext`\[Sigma], 
           Blank[]], 
          Pattern[$CellContext`T, 
           Blank[]], 
          Pattern[$CellContext`n, 
           Blank[]]] := If[$CellContext`T == 0, 
          $CellContext`powerPayoff[
          "call", $CellContext`S, $CellContext`k, $CellContext`n], \
($CellContext`S^$CellContext`n 
            Exp[(($CellContext`n - 
                 1) ($CellContext`r + $CellContext`n ($CellContext`\[Sigma]^2/
                   2)) - $CellContext`n $CellContext`q) $CellContext`T]) \
$CellContext`\[ScriptCapitalN][
             $CellContext`d1[$CellContext`S, $CellContext`k, $CellContext`r, \
$CellContext`q, $CellContext`\[Sigma], $CellContext`T, $CellContext`n]] - \
($CellContext`k 
           Exp[(-$CellContext`r) $CellContext`T]) $CellContext`\
\[ScriptCapitalN][
            $CellContext`d2[$CellContext`S, $CellContext`k, $CellContext`r, \
$CellContext`q, $CellContext`\[Sigma], $CellContext`T, $CellContext`n]]], \
$CellContext`powerPrice["put", 
          Pattern[$CellContext`S, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`r, 
           Blank[]], 
          Pattern[$CellContext`q, 
           Blank[]], 
          Pattern[$CellContext`\[Sigma], 
           Blank[]], 
          Pattern[$CellContext`T, 
           Blank[]], 
          Pattern[$CellContext`n, 
           Blank[]]] := If[$CellContext`T == 0, 
          $CellContext`powerPayoff[
          "put", $CellContext`S, $CellContext`k, $CellContext`n], \
($CellContext`k 
            Exp[(-$CellContext`r) $CellContext`T]) $CellContext`\
\[ScriptCapitalN][-$CellContext`d2[$CellContext`S, $CellContext`k, \
$CellContext`r, $CellContext`q, $CellContext`\[Sigma], $CellContext`T, \
$CellContext`n]] - ($CellContext`S^$CellContext`n 
           Exp[(($CellContext`n - 
                1) ($CellContext`r + $CellContext`n ($CellContext`\[Sigma]^2/
                  2)) - $CellContext`n $CellContext`q) $CellContext`T]) \
$CellContext`\[ScriptCapitalN][-$CellContext`d1[$CellContext`S, \
$CellContext`k, $CellContext`r, $CellContext`q, $CellContext`\[Sigma], \
$CellContext`T, $CellContext`n]]], $CellContext`powerPayoff["call", 
          Pattern[$CellContext`S, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`n, 
           Blank[]]] := 
        Max[$CellContext`S^$CellContext`n - $CellContext`k, 
          0], $CellContext`powerPayoff["put", 
          Pattern[$CellContext`S, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`n, 
           Blank[]]] := 
        Max[$CellContext`k - $CellContext`S^$CellContext`n, 
          0], $CellContext`\[ScriptCapitalN][
          Pattern[$CellContext`z, 
           Blank[]]] := If[
           And[
            NumericQ[$CellContext`z], $CellContext`z < 0], 
           Erfc[-($CellContext`z/Sqrt[2])], 1 + Erf[$CellContext`z/Sqrt[2]]]/
         2, $CellContext`d1[
          Pattern[$CellContext`S, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`r, 
           Blank[]], 
          Pattern[$CellContext`q, 
           Blank[]], 
          Pattern[$CellContext`\[Sigma], 
           Blank[]], 
          Pattern[$CellContext`T, 
           Blank[]], 
          Pattern[$CellContext`n, 
           Blank[]]] := (
          Log[$CellContext`S/$CellContext`k^(
             1/$CellContext`n)] + ($CellContext`r - $CellContext`q + \
($CellContext`n - 1/
              2) $CellContext`\[Sigma]^2) $CellContext`T)/($CellContext`\
\[Sigma] Sqrt[$CellContext`T]), $CellContext`d2[
          Pattern[$CellContext`S, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`r, 
           Blank[]], 
          Pattern[$CellContext`q, 
           Blank[]], 
          Pattern[$CellContext`\[Sigma], 
           Blank[]], 
          Pattern[$CellContext`T, 
           Blank[]], 
          Pattern[$CellContext`n, 
           
           Blank[]]] := $CellContext`d1[$CellContext`S, $CellContext`k, \
$CellContext`r, $CellContext`q, $CellContext`\[Sigma], $CellContext`T, \
$CellContext`n] - ($CellContext`n $CellContext`\[Sigma]) 
         Sqrt[$CellContext`T], $CellContext`x = 1., $CellContext`plotOpts = 
        Sequence[
         PlotRange -> All, Filling -> {1 -> {2}}, ImageSize -> 400, 
          ImagePadding -> 40, Axes -> False, Frame -> True, 
          FrameLabel -> {
           "spot price / \!\(\*SuperscriptBox[\(strike\), \(1/n\)]\)", 
            "option price / strike"}, AxesOrigin -> {0, 0}, PlotStyle -> {{
             Thickness[Large], 
             Hue[0.67, 0.6, 0.6]}, {
             Thickness[Large], 
             Dashing[{Small, Small}], 
             Hue[0.91, 0.6, 0.6]}}, Prolog -> {
            Dashing[{0, Small}], 
            Line[{{1, -1000}, {1, 1000}}]}], $CellContext`legend = Row[{
           Text[
            Style["current price", 
             GrayLevel[0], 12]], 
           Graphics[{
             Thickness[Large], 
             Hue[0.67, 0.6, 0.6], 
             Line[{{0, 0}, {1, 0}}]}, AspectRatio -> 0.1, ImageSize -> 30], 
           Text[
            Style["value at expiry", 
             GrayLevel[0], 12]], 
           Graphics[{
             Thickness[Large], 
             Dashing[{Small, Small}], 
             Hue[0.91, 0.6, 0.6], 
             Line[{{0, 0}, {1, 0}}]}, AspectRatio -> 0.1, ImageSize -> 30]}, 
          "   "]}; Typeset`initDone$$ = True); ReleaseHold[
       HoldComplete[{$CellContext`\[ScriptCapitalN][
           Pattern[$CellContext`z, 
            Blank[]]] := If[
            And[
             NumericQ[$CellContext`z], $CellContext`z < 0], 
            Erfc[(-$CellContext`z)/Sqrt[2]], 1 + Erf[$CellContext`z/Sqrt[2]]]/
          2, {
          HoldComplete[$CellContext`d1[
             Pattern[$CellContext`S, 
              Blank[]], 
             Pattern[$CellContext`k, 
              Blank[]], 
             Pattern[$CellContext`r, 
              Blank[]], 
             Pattern[$CellContext`q, 
              Blank[]], 
             Pattern[$CellContext`\[Sigma], 
              Blank[]], 
             Pattern[$CellContext`T, 
              Blank[]], 
             Pattern[$CellContext`n, 
              Blank[]]] := (
             Log[$CellContext`S/$CellContext`k^(
                1/$CellContext`n)] + ($CellContext`r - $CellContext`q + \
($CellContext`n - 1/
                 2) $CellContext`\[Sigma]^2) $CellContext`T)/($CellContext`\
\[Sigma] Sqrt[$CellContext`T])], 
          HoldComplete[Null], 
          HoldComplete[$CellContext`d2[
             Pattern[$CellContext`S, 
              Blank[]], 
             Pattern[$CellContext`k, 
              Blank[]], 
             Pattern[$CellContext`r, 
              Blank[]], 
             Pattern[$CellContext`q, 
              Blank[]], 
             Pattern[$CellContext`\[Sigma], 
              Blank[]], 
             Pattern[$CellContext`T, 
              Blank[]], 
             Pattern[$CellContext`n, 
              
              Blank[]]] := $CellContext`d1[$CellContext`S, $CellContext`k, \
$CellContext`r, $CellContext`q, $CellContext`\[Sigma], $CellContext`T, \
$CellContext`n] - $CellContext`n $CellContext`\[Sigma] 
            Sqrt[$CellContext`T]]}, {
          HoldComplete[$CellContext`powerPayoff["call", 
             Pattern[$CellContext`S, 
              Blank[]], 
             Pattern[$CellContext`k, 
              Blank[]], 
             Pattern[$CellContext`n, 
              Blank[]]] := 
           Max[$CellContext`S^$CellContext`n - $CellContext`k, 0]], 
          HoldComplete[Null], 
          HoldComplete[$CellContext`powerPayoff["put", 
             Pattern[$CellContext`S, 
              Blank[]], 
             Pattern[$CellContext`k, 
              Blank[]], 
             Pattern[$CellContext`n, 
              Blank[]]] := 
           Max[$CellContext`k - $CellContext`S^$CellContext`n, 
             0]]}, $CellContext`powerPrice["call", 
           Pattern[$CellContext`S, 
            Blank[]], 
           Pattern[$CellContext`k, 
            Blank[]], 
           Pattern[$CellContext`r, 
            Blank[]], 
           Pattern[$CellContext`q, 
            Blank[]], 
           Pattern[$CellContext`\[Sigma], 
            Blank[]], 
           Pattern[$CellContext`T, 
            Blank[]], 
           Pattern[$CellContext`n, 
            Blank[]]] := If[$CellContext`T == 0, 
           $CellContext`powerPayoff[
           "call", $CellContext`S, $CellContext`k, $CellContext`n], \
$CellContext`S^$CellContext`n 
            Exp[(($CellContext`n - 
                 1) ($CellContext`r + $CellContext`n ($CellContext`\[Sigma]^2/
                   2)) - $CellContext`n $CellContext`q) $CellContext`T] \
$CellContext`\[ScriptCapitalN][
              $CellContext`d1[$CellContext`S, $CellContext`k, $CellContext`r, \
$CellContext`q, $CellContext`\[Sigma], $CellContext`T, $CellContext`n]] - \
$CellContext`k 
           Exp[(-$CellContext`r) $CellContext`T] $CellContext`\
\[ScriptCapitalN][
             $CellContext`d2[$CellContext`S, $CellContext`k, $CellContext`r, \
$CellContext`q, $CellContext`\[Sigma], $CellContext`T, $CellContext`n]]], \
$CellContext`powerPrice["put", 
           Pattern[$CellContext`S, 
            Blank[]], 
           Pattern[$CellContext`k, 
            Blank[]], 
           Pattern[$CellContext`r, 
            Blank[]], 
           Pattern[$CellContext`q, 
            Blank[]], 
           Pattern[$CellContext`\[Sigma], 
            Blank[]], 
           Pattern[$CellContext`T, 
            Blank[]], 
           Pattern[$CellContext`n, 
            Blank[]]] := If[$CellContext`T == 0, 
           $CellContext`powerPayoff[
           "put", $CellContext`S, $CellContext`k, $CellContext`n], \
$CellContext`k 
            Exp[(-$CellContext`r) $CellContext`T] $CellContext`\
\[ScriptCapitalN][-$CellContext`d2[$CellContext`S, $CellContext`k, \
$CellContext`r, $CellContext`q, $CellContext`\[Sigma], $CellContext`T, \
$CellContext`n]] - $CellContext`S^$CellContext`n 
           Exp[(($CellContext`n - 
                1) ($CellContext`r + $CellContext`n ($CellContext`\[Sigma]^2/
                  2)) - $CellContext`n $CellContext`q) $CellContext`T] \
$CellContext`\[ScriptCapitalN][-$CellContext`d1[$CellContext`S, \
$CellContext`k, $CellContext`r, $CellContext`q, $CellContext`\[Sigma], \
$CellContext`T, $CellContext`n]]], $CellContext`lineStyles = {{Thick, 
             Hue[0.67, 0.6, 0.6]}, {Thick, Dashed, 
             Hue[0.91, 0.6, 0.6]}}; 
         Null, $CellContext`plotOpts = 
          Sequence[
           PlotRange -> All, Filling -> {1 -> {2}}, ImageSize -> 400, 
            ImagePadding -> 40, Axes -> False, Frame -> True, 
            FrameLabel -> {
             "spot price / \!\(\*SuperscriptBox[\(strike\), \(1/n\)]\)", 
              "option price / strike"}, AxesOrigin -> {0, 0}, 
            PlotStyle -> $CellContext`lineStyles, Prolog -> {Dotted, 
              Line[{{1, -1000}, {1, 1000}}]}]; 
         Null, $CellContext`legend = Row[
            Flatten[
             Transpose[{
               Map[Text[
                 Style[#, Black, 12]]& , {
                "current price", "value at expiry"}], 
               Map[Graphics[
                 Flatten[{#, 
                   Line[{{0, 0}, {1, 0}}]}], AspectRatio -> 0.1, ImageSize -> 
                 30]& , $CellContext`lineStyles]}]], "   "]; 
         Null, $CellContext`$spot = 1.; Null}]]; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->380940328],

Cell[CellGroupData[{

Cell["THIS NOTEBOOK IS THE SOURCE CODE FROM", "Text",
 CellFrame->{{0, 0}, {0, 1}},
 CellMargins->{{48, 10}, {4, 28}},
 CellGroupingRules->{"SectionGrouping", 25},
 CellFrameMargins->{{48, 48}, {6, 5}},
 CellFrameColor->RGBColor[0.691905, 0.790311, 0.300252],
 FontFamily->"Helvetica",
 FontSize->10,
 FontWeight->"Bold",
 FontColor->RGBColor[0.691905, 0.790311, 0.300252]],

Cell[TextData[{
 "\"",
 ButtonBox["Pricing Power Options in the Black-Scholes Model",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/\
PricingPowerOptionsInTheBlackScholesModel/"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/\
PricingPowerOptionsInTheBlackScholesModel/"],
 "\"",
 " from ",
 ButtonBox["The Wolfram Demonstrations Project",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/"], None},
  ButtonNote->"http://demonstrations.wolfram.com/"],
 "\[ParagraphSeparator]\[NonBreakingSpace]",
 ButtonBox["http://demonstrations.wolfram.com/\
PricingPowerOptionsInTheBlackScholesModel/",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/\
PricingPowerOptionsInTheBlackScholesModel/"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/\
PricingPowerOptionsInTheBlackScholesModel/"]
}], "Text",
 CellMargins->{{48, Inherited}, {0, Inherited}},
 FontFamily->"Verdana",
 FontSize->10,
 FontColor->GrayLevel[0.5]],

Cell[" ", "Text",
 CellFrame->{{0, 0}, {0, 1}},
 CellMargins->{{48, 10}, {4, 28}},
 CellGroupingRules->{"SectionGrouping", 25},
 CellFrameMargins->{{48, 48}, {6, 5}},
 CellFrameColor->RGBColor[0.691905, 0.790311, 0.300252],
 FontFamily->"Helvetica",
 FontSize->10,
 FontWeight->"Bold",
 FontColor->RGBColor[0.691905, 0.790311, 0.300252]],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Peter Falloon",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Peter+Falloon"],
     None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Peter+Falloon"]
}], "Text",
 CellDingbat->"\[FilledSmallSquare]",
 CellMargins->{{66, 48}, {2, 4}},
 FontFamily->"Verdana",
 FontSize->10,
 FontColor->GrayLevel[0.6]],

Cell[CellGroupData[{

Cell[TextData[{
 "A full-function Wolfram ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " system (Version 6 or higher) is required to edit this notebook.\n",
 StyleBox[ButtonBox["GET WOLFRAM MATHEMATICA \[RightGuillemet]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.wolfram.com/products/mathematica/"], None},
  ButtonNote->"http://www.wolfram.com/products/mathematica/"],
  FontFamily->"Helvetica",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->RGBColor[1, 0.42, 0]]
}], "Text",
 CellFrame->True,
 CellMargins->{{48, 68}, {8, 28}},
 CellFrameMargins->12,
 CellFrameColor->RGBColor[0.865507, 0.90634, 0.680751],
 CellChangeTimes->{3.3750111182355957`*^9},
 ParagraphSpacing->{1., 1.},
 FontFamily->"Verdana",
 FontSize->10,
 FontColor->GrayLevel[0.411765],
 Background->RGBColor[0.986023, 0.991363, 0.969818]],

Cell[TextData[{
 "\[Copyright] ",
 StyleBox[ButtonBox["The Wolfram Demonstrations Project & Contributors",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/"], None},
  ButtonNote->"http://demonstrations.wolfram.com/"],
  FontColor->GrayLevel[0.6]],
 "\[ThickSpace]\[ThickSpace]\[ThickSpace]|\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
 StyleBox[ButtonBox["Terms of Use",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/termsofuse.html"], None},
  ButtonNote->"http://demonstrations.wolfram.com/termsofuse.html"],
  FontColor->GrayLevel[0.6]],
 "\[ThickSpace]\[ThickSpace]\[ThickSpace]|\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
 StyleBox[ButtonBox["Make a new version of this Demonstration \
\[RightGuillemet]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/participate/upload.jsp?id=\
PricingPowerOptionsInTheBlackScholesModel"], None},
  ButtonNote->None],
  FontColor->GrayLevel[0.6]]
}], "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellMargins->{{48, 10}, {20, 50}},
 CellFrameMargins->{{6, 0}, {6, 6}},
 CellFrameColor->GrayLevel[0.6],
 FontFamily->"Verdana",
 FontSize->9,
 FontColor->GrayLevel[0.6]]
}, Open  ]]
}, Open  ]]
},
Editable->True,
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{710, 650},
WindowMargins->{{Inherited, Inherited}, {Inherited, 0}},
WindowElements->{
 "StatusArea", "MemoryMonitor", "MagnificationPopUp", "VerticalScrollBar", 
  "MenuBar"},
WindowTitle->"Pricing Power Options in the Black-Scholes Model - Source",
DockedCells->{},
CellContext->Notebook,
FrontEndVersion->"6.0 for Microsoft Windows (32-bit) (May 21, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[590, 23, 240, 4, 70, "Section"],
Cell[833, 29, 662, 21, 70, "Input",
 InitializationCell->True,
 CellID->851891787],
Cell[1498, 52, 1345, 42, 70, "Input",
 InitializationCell->True,
 CellID->471789560],
Cell[2846, 96, 794, 21, 70, "Input",
 InitializationCell->True,
 CellID->1432920567],
Cell[3643, 119, 1728, 47, 70, "Input",
 InitializationCell->True,
 CellID->2005977559],
Cell[5374, 168, 1721, 48, 70, "Input",
 InitializationCell->True,
 CellID->1119059860],
Cell[7098, 218, 557, 17, 70, "Input",
 InitializationCell->True,
 CellID->1665088774],
Cell[7658, 237, 2255, 50, 70, "Input",
 InitializationCell->True,
 CellID->1819795727],
Cell[9916, 289, 1548, 42, 70, "Input",
 InitializationCell->True,
 CellID->1450068990],
Cell[11467, 333, 237, 7, 70, "Input",
 InitializationCell->True,
 CellID->692450422],
Cell[11707, 342, 4212, 95, 70, "Input",
 CellID->152103638]
}, Open  ]],
Cell[15934, 440, 24391, 507, 70, "Output",
 CellID->380940328],
Cell[CellGroupData[{
Cell[40350, 951, 373, 9, 70, "Text",
 CellGroupingRules->{"SectionGrouping", 25}],
Cell[40726, 962, 1048, 31, 70, "Text"],
Cell[41777, 995, 337, 9, 70, "Text",
 CellGroupingRules->{"SectionGrouping", 25}],
Cell[42117, 1006, 436, 14, 70, "Text"],
Cell[CellGroupData[{
Cell[42578, 1024, 847, 24, 70, "Text"],
Cell[43428, 1050, 1217, 33, 70, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
(* NotebookSignature bQjNmSt7bKTmGCpFPXhkGPYo *)
